Rev1.8 Python 3.9.7にて動作確認済み
・vrs結果読み取り中にフリーズする対策(検証中)
　vrstime_print()で、NucleoからのEndコマンドをwhileで待つ処理を追加。
　以前は、他アプリ操作なので取りこぼしてした模様？
　上記処理を追加したところ、野邉の環境では測定中にexcel操作保存を連打しても止まらなくなった。
・M1制御追加

Rev1.70
・シーケンスファイルの複数読み込み対応
　複数読み込み
　ファイル読み込み時に、Ctrlやshiftキーと組み合わせて複数ファイル選択可能
　読み込むと、スタート/ストップボタン横にファイル名をプルダウン表示追加
　→選択して読込ボタンで設定反映
　
　複数実行
　プルダウン選択に応じてスタートボタンの動作を変更
　　表示設定	　：画面に表示している設定でシーケンス実行
　　設定ファイル名：ファイルを読み込んで、設定更新してからシーケンス実行
　　全て実行	　：ファイルを順次読み込んで、シーケンス実行

・シーケンス実行後の出力ファイル
　　Outputファイル名に、シーケンス設定ファイル名を追記
　　全て実行時は、Outputファイルにまとめて保存
　　→originフォルダに個別ファイルも念のため保存(次のVerでは削除予定)

・小針検出対応
　小針の場合PI出力が小さいため検出閾値修正
　Full step 180以下の場合は低電圧でも反応OKとする

・Vrs enableの初期値を無効に変更

・3端子駆動対応
　train3ファイルを使用することで3端子駆動可能
　変換コネクタ経由接続すれば、間違ったパルスでもハード故障防げる

・パルス出力後のwait短縮
　パルス出力後に50us程度のwaitが必ず入っていたのを修正。
　→vrs用のPWM設定が原因だったため、vrs無効時は10usまで短縮
　　vrs有効時は変わらず

・パルス出力途中停止機能追加
　PC_14にHi入力するとパルス出力強制停止

・Auto Focus機能付きwebカメラ対応
　Fix Focusモードにして、キーボードの「f」「n」で焦点距離調整可能。
　「a」を押すとAuto focus有効化

・シーケンスのstep値をゼロの対応
　stepに0ば入力された場合は、0以上にするようアラート表示
  

Rev1.62
・フォト検出モード変更
　従来 0:通常、1:秒針、2:-、3:最短移動
　今回 0:通常、1:最短移動、2:逆極性chk
　※Fullstep設定が180step未満だったら、従来の秒針モードに自動変更になります。

・逆極性chkモード
 ・逆極性chkモード　ミスステップが10ステップ以下だったらOK判定。(変数pierr_stepmiss)
   結果にズレたステップ数を記録しているので、都度NGステップ数は判断　
   動作説明を別スレッドに記載

・Disk/20step評価対応
  PI検出のFullstepに応じて、NG判定するステップ数を変更する。
　1ステップあたりの移動量が小さくなるとフォトインタラプタでの判断が難しくなるため。　
  180step未満：2stepズレでNG判定
  180以上　　：3+Fullstep/360ズレたらNG判定。　　　　　　　　
  →Diskは1860stepなので3+5=8step以上ズレたらNG

・その他
　保存ファイル名に、ファイル名に使えない文字列があった場合に「-」に置換する。
　シーケンススタート時にファイル設定を再読み込みする(設定送信押し忘れ対策)
　補助駆動パルスやPrパルスの際は設定周波数エラー表示出さない

・β版機能
　Vdmin結果保存などを行った際に、csvと同じ名前で設定項目を画像で保存する。
　※マルチディスプレイ時にサブディスプレイ側にウィンドウを持っていくとうまく動作しない。

Rev1.6
※ファイルの保存場所を変更します。teams上でexeファイルが保存できなくなったため。
　\\Mkwkoi\共同作業\要素開発\M設計・生産支援技術\2. 測定技術\MC-Pad
 
※パルス設定Excel(train)ファイルが新規になりました。train→train2
　従来のファイルも使用できますが、従来ファイルだと以下機能が使えません
　・パルス出力中のSPK出力設定
　・パルス種4,5の設定
 
・設定パルス種追加
　Pulse4,5の設定を追加
　→基本的には1,2を開発用パルス、4,5は標準パルスを設定する考え
・Vrs検出機能
　NG判定ステップ位置を、フォトOffsetへコピー入力機能追加。
　→3ステップ以上差がないとコピーしない。
・パルス中SPK出力機能
　パルス出力中のSPK出力を有効化
　→パルス設定フォーム更新
・フォト検出機能
　フォト位置オフセット毎にファイル保存 ※途中停止した場合の対策
　位置セットした際にもフォト設定更新
  フォト検出用パルスにPulse4,5の選択追加
・パルス幅が設定周波数より長い場合注意
　設定周波数のスピードが出せない場合に、実動作周波数を注意表示。自動で消えます。


Rev1.51
・シーケンス機能
 　Vdmin測定途中ストップでもファイル保存
 　電圧条件変更した際に前回がフォト検出OKだったら初期位置セットやらない
 　→電圧一定でDuty可変測定した際の測定短時間化
・Vrs検出機能
　判定/Pattern/Timing別々の結果表示だったのを結合。詳細保存内容は変更なし。
　NG判定ステップ位置と前後のステップ差表示

Rev1.5
・パルス出力中もフォト検出追加(秒針対応)
 検出モード　0:通常　→従来と同じ。針静止後にフォト検出
　　　　　　 1:秒針等→パルス中もフォト検出。針の通過で判定。

Rev1.42
・起動時初期設定読み込み時のprint行不整合を修正
・フォト検出時に1step検出モード追加
・シーケンス設定の周波数有効ボタン追加
・任意Vcomp設定追加
・シーケンス設定読み込み時に、以下項目も読み込み
　フォトNG停止/周波数設定/結果保存/詳細結果保存

Rev1.0更新内容
・駆動周波数を設定できるように修正(以前はパルス後のWait時間を入力)
　パルス長さが駆動周期より長い場合、設定周波数よりも自動で遅くなるので注意
・PWM出力ポートが1-4逆だったのを修正(出力判定も逆だったので、最終的な結果は同じ)

・シーケンス機能に電圧/パルス幅/周波数可変設定追加
・フォト検出結果/Vrs検出結果保存機能
・パルス幅変更する際に適用しない区間を設定可能

・Vrs検出タイミング表示ウィンドウ追加
・1step毎のVrsタイミング/パターン/判定結果保存

・ボタンを押した際にウィンドウが複数開かないように修正
　すでに開いている場合は、最前面に表示する

Rev0.91更新内容
・Pulse出力 「Anystep 往復」追加
・フォトインタラプタVdmin測定機能追加
　パルス幅比率 5段階 x Waitタイム5段階設定可能
　CSVに動作マップ保存
・Nucleo revチェック機能追加
　Nucleoのrevが異なるとエラーメッセージ表示。
　表示を消せばそのまま使うことは可能(不具合生じる可能性
・Vrsタイミング記録β版
　Vrs有効時にタイミング保存しターミナル上に表示
　上記機能追加に伴い、パルス幅時間管理をwait→タイマーポーリングに変更
・パルス幅補正が行われていなかったのを修正(デバッグNo.16)

Rev0.8更新内容
・フォトインタラプタ針位置検出機能 β版追加
・wait vrs機能一旦廃止(分かりにくいため）
・パルスオプションの逆極性が消えていたため復活
・カメラ機能追加
　0キー押し：Pulse0でスタート
　1キー押し：Pulse1でスタート
　mキー押し：Pulse0 Anystep送ってから撮影。電圧ステップ動作対応。

Rev0.7更新内容
・表示パルス数を2パルス+Prに限定（分かり易さのため)
・MC-Pad起動時に「initial_train.xlsx」読み込み &設定
　→読み込みファイル変更で2パルスを6パルスまで拡張可能
・train/seqファイルが見つからない場合や、読み込みエラー時にメッセージ表示
・Pulse設定読み込みを、_train.xlsxのみに。
　→width.xlsxは廃止
・Pulse出力は、Pulse-0と1に固定
　→Pulse設定のPulse選択廃止
・パルス列設定に各区間のパルス状態を記載
・デバッグ指摘修正 3,5,8

Rev0.6更新内容
・カメラオプション追加
任意ステップ動作毎にカメラ撮影実行(運針ムラ測定想定）
出力パルスはAnystep設定と共通
パルス出力後のDelayタイム設定可能(0.1～1秒)
カメラ選択可能(通常 0が内蔵カメラ、外付け1～）

Rev0.5更新内容
・パルス列をexcelファイルから読み込み「_train.xlsx」
・オプションwindowの表示位置を調整
・0.4でSPK出せなくなっていたバグ修正

Rev0.4更新内容
・読み込みexcelファイル名表示
・Pulse出力時に、指定した電圧stepで可変機能(±指定可)追加
・シーケンスを別windowとし、設定数を5→10に増加
・設定送信実行時に、完了までボタンの見た目が変わるように変更

Rev0.3更新内容
・DAC電圧変更機能
・Peパルス追加(Pe幅とwait設定)
・Vrs周期とON時間調整追加
・パルス設定をexcelファイルから読込「width.xlsx」
・シーケンス設定をパexcelファイルから読込「seq.xlsx」